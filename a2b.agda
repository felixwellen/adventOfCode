{-
  Day 2, 2nd part
-}
module a2b where

open import Agda.Builtin.IO using (IO)
open import Agda.Builtin.Unit using (⊤)
open import Agda.Builtin.String using (String; primShowNat; primStringAppend)
open import Agda.Builtin.Equality

open import Data.Nat
open import Data.Bool using (if_then_else_)
open import Data.List
open import Data.Maybe renaming (map to maybeMap)

postulate putStrLn : String → IO ⊤
{-# FOREIGN GHC import qualified Data.Text as T #-}
{-# COMPILE GHC putStrLn = putStrLn . T.unpack #-}

-- helper
shopMaybeNat : Maybe ℕ → String
shopMaybeNat (just n) = primShowNat n
shopMaybeNat nothing = "nothing"

data Command : Set where
  forward : ℕ → Command
  up      : ℕ → Command
  down    : ℕ → Command

record Position : Set where
  constructor pos
  field
    h : ℕ
    d : ℕ

{- Alignment of the submarine, i.e. position and aim -}
record Alignment : Set where
  constructor state
  field
    h : ℕ
    d : ℕ
    aim : ℕ

open Position

apply : Command → Alignment → Maybe Alignment

apply (forward x) (state h d aim) = just (state (h + x) (d + (x * aim)) aim)

apply (up x)      (state h d aim) = if aim <ᵇ x
                                    then nothing
                                    else just (state h d ∣ aim - x ∣)

apply (down x) (state h d aim) = just (state h d (aim + x))


iterate : List Command → Alignment → Maybe Alignment
iterate [] a = just a
iterate (command ∷ list) a with apply command a
...                           | just a'  = iterate list a'
...                           | nothing = nothing

doTask : List Command → Maybe ℕ
doTask list = let maybeResult = iterate list (state 0 0 0)
              in maybeMap multiplyComponents maybeResult
  where multiplyComponents : Alignment → ℕ
        multiplyComponents (state h d aim) = h * d

input : List Command
input =
  forward 2 ∷
  forward 3 ∷
  forward 5 ∷
  forward 6 ∷
  down 7 ∷
  forward 8 ∷
  forward 4 ∷
  forward 7 ∷
  forward 5 ∷
  forward 5 ∷
  down 4 ∷
  down 9 ∷
  forward 8 ∷
  forward 5 ∷
  up 5 ∷
  down 5 ∷
  forward 3 ∷
  down 4 ∷
  down 8 ∷
  forward 9 ∷
  down 1 ∷
  up 9 ∷
  down 7 ∷
  up 7 ∷
  up 1 ∷
  forward 1 ∷
  down 1 ∷
  down 4 ∷
  down 4 ∷
  down 8 ∷
  down 4 ∷
  up 3 ∷
  down 1 ∷
  down 3 ∷
  forward 7 ∷
  down 6 ∷
  forward 3 ∷
  forward 5 ∷
  forward 2 ∷
  up 9 ∷
  forward 7 ∷
  up 5 ∷
  down 3 ∷
  forward 1 ∷
  forward 2 ∷
  down 3 ∷
  down 8 ∷
  down 3 ∷
  forward 8 ∷
  up 5 ∷
  down 5 ∷
  forward 3 ∷
  down 5 ∷
  forward 9 ∷
  down 3 ∷
  down 4 ∷
  down 9 ∷
  down 7 ∷
  up 3 ∷
  down 9 ∷
  up 9 ∷
  up 1 ∷
  forward 3 ∷
  up 4 ∷
  down 3 ∷
  forward 7 ∷
  forward 7 ∷
  up 7 ∷
  forward 6 ∷
  down 7 ∷
  down 6 ∷
  forward 2 ∷
  forward 9 ∷
  down 5 ∷
  forward 4 ∷
  up 6 ∷
  down 1 ∷
  down 9 ∷
  down 9 ∷
  forward 4 ∷
  down 1 ∷
  forward 6 ∷
  down 1 ∷
  down 5 ∷
  down 4 ∷
  down 4 ∷
  forward 4 ∷
  forward 9 ∷
  up 1 ∷
  down 2 ∷
  down 8 ∷
  down 5 ∷
  down 8 ∷
  down 8 ∷
  up 2 ∷
  forward 8 ∷
  up 1 ∷
  forward 4 ∷
  down 5 ∷
  down 1 ∷
  up 2 ∷
  forward 6 ∷
  forward 9 ∷
  forward 2 ∷
  forward 6 ∷
  forward 9 ∷
  up 6 ∷
  forward 9 ∷
  up 4 ∷
  down 7 ∷
  up 6 ∷
  forward 2 ∷
  down 1 ∷
  up 3 ∷
  forward 1 ∷
  forward 8 ∷
  down 6 ∷
  down 8 ∷
  down 8 ∷
  forward 8 ∷
  forward 2 ∷
  forward 2 ∷
  down 2 ∷
  up 1 ∷
  down 9 ∷
  up 9 ∷
  down 9 ∷
  up 3 ∷
  forward 9 ∷
  up 4 ∷
  up 7 ∷
  up 6 ∷
  down 9 ∷
  forward 1 ∷
  down 3 ∷
  down 4 ∷
  forward 8 ∷
  down 3 ∷
  down 9 ∷
  up 3 ∷
  forward 2 ∷
  up 5 ∷
  down 3 ∷
  forward 8 ∷
  up 3 ∷
  down 3 ∷
  forward 2 ∷
  forward 9 ∷
  down 1 ∷
  down 9 ∷
  down 4 ∷
  up 7 ∷
  down 4 ∷
  up 6 ∷
  forward 5 ∷
  down 6 ∷
  forward 3 ∷
  down 2 ∷
  forward 1 ∷
  forward 8 ∷
  down 4 ∷
  forward 1 ∷
  up 7 ∷
  forward 6 ∷
  up 9 ∷
  forward 6 ∷
  down 3 ∷
  forward 2 ∷
  down 4 ∷
  forward 6 ∷
  down 3 ∷
  down 6 ∷
  down 1 ∷
  down 1 ∷
  down 5 ∷
  forward 3 ∷
  forward 9 ∷
  forward 8 ∷
  down 3 ∷
  forward 7 ∷
  up 9 ∷
  forward 9 ∷
  up 2 ∷
  forward 4 ∷
  up 3 ∷
  forward 1 ∷
  up 6 ∷
  up 8 ∷
  down 5 ∷
  down 6 ∷
  up 9 ∷
  down 6 ∷
  down 9 ∷
  up 9 ∷
  down 4 ∷
  forward 5 ∷
  up 2 ∷
  down 3 ∷
  up 3 ∷
  down 1 ∷
  forward 3 ∷
  down 5 ∷
  forward 7 ∷
  down 6 ∷
  down 7 ∷
  down 5 ∷
  forward 2 ∷
  up 6 ∷
  down 9 ∷
  down 4 ∷
  down 3 ∷
  forward 9 ∷
  up 8 ∷
  forward 2 ∷
  down 2 ∷
  forward 4 ∷
  up 6 ∷
  down 4 ∷
  up 8 ∷
  down 7 ∷
  down 2 ∷
  up 6 ∷
  up 4 ∷
  down 2 ∷
  forward 5 ∷
  up 4 ∷
  down 8 ∷
  forward 3 ∷
  forward 1 ∷
  down 7 ∷
  forward 8 ∷
  forward 7 ∷
  down 7 ∷
  up 4 ∷
  forward 8 ∷
  down 5 ∷
  up 9 ∷
  forward 1 ∷
  forward 4 ∷
  forward 9 ∷
  forward 7 ∷
  down 9 ∷
  up 9 ∷
  down 1 ∷
  down 7 ∷
  forward 7 ∷
  down 7 ∷
  down 7 ∷
  down 3 ∷
  down 5 ∷
  forward 3 ∷
  down 2 ∷
  forward 6 ∷
  down 9 ∷
  up 5 ∷
  up 3 ∷
  forward 5 ∷
  down 6 ∷
  down 1 ∷
  forward 4 ∷
  down 3 ∷
  forward 8 ∷
  down 7 ∷
  forward 7 ∷
  forward 7 ∷
  up 7 ∷
  up 2 ∷
  up 3 ∷
  forward 9 ∷
  down 5 ∷
  up 2 ∷
  forward 5 ∷
  up 5 ∷
  forward 2 ∷
  forward 2 ∷
  down 8 ∷
  forward 2 ∷
  up 4 ∷
  forward 1 ∷
  forward 3 ∷
  up 8 ∷
  up 9 ∷
  forward 5 ∷
  down 1 ∷
  up 8 ∷
  down 4 ∷
  down 8 ∷
  up 4 ∷
  forward 9 ∷
  down 6 ∷
  down 8 ∷
  up 2 ∷
  up 3 ∷
  down 7 ∷
  down 4 ∷
  forward 5 ∷
  down 6 ∷
  forward 3 ∷
  forward 3 ∷
  forward 8 ∷
  down 1 ∷
  down 7 ∷
  down 9 ∷
  down 2 ∷
  down 7 ∷
  forward 7 ∷
  down 7 ∷
  down 6 ∷
  up 6 ∷
  forward 8 ∷
  forward 5 ∷
  up 5 ∷
  down 2 ∷
  up 8 ∷
  up 4 ∷
  down 9 ∷
  up 2 ∷
  forward 5 ∷
  up 2 ∷
  down 4 ∷
  up 4 ∷
  forward 2 ∷
  forward 4 ∷
  forward 9 ∷
  forward 9 ∷
  up 4 ∷
  up 5 ∷
  down 1 ∷
  down 6 ∷
  down 1 ∷
  down 4 ∷
  down 5 ∷
  down 3 ∷
  forward 3 ∷
  down 9 ∷
  forward 6 ∷
  down 3 ∷
  down 9 ∷
  down 2 ∷
  up 2 ∷
  down 2 ∷
  down 7 ∷
  forward 9 ∷
  down 3 ∷
  down 3 ∷
  down 2 ∷
  down 3 ∷
  forward 2 ∷
  down 9 ∷
  down 9 ∷
  up 5 ∷
  up 3 ∷
  forward 4 ∷
  up 7 ∷
  forward 8 ∷
  up 6 ∷
  forward 7 ∷
  down 7 ∷
  down 1 ∷
  forward 5 ∷
  down 2 ∷
  up 1 ∷
  down 8 ∷
  up 3 ∷
  forward 2 ∷
  up 9 ∷
  down 1 ∷
  down 3 ∷
  down 6 ∷
  down 2 ∷
  down 7 ∷
  up 2 ∷
  forward 5 ∷
  forward 7 ∷
  down 2 ∷
  forward 5 ∷
  forward 4 ∷
  forward 5 ∷
  down 3 ∷
  forward 7 ∷
  down 7 ∷
  forward 8 ∷
  down 3 ∷
  down 2 ∷
  up 1 ∷
  forward 6 ∷
  down 4 ∷
  down 2 ∷
  forward 7 ∷
  up 3 ∷
  down 4 ∷
  forward 2 ∷
  up 6 ∷
  down 3 ∷
  up 6 ∷
  up 8 ∷
  down 9 ∷
  up 6 ∷
  forward 8 ∷
  forward 9 ∷
  forward 4 ∷
  forward 7 ∷
  down 2 ∷
  forward 9 ∷
  down 7 ∷
  up 9 ∷
  down 5 ∷
  down 6 ∷
  up 5 ∷
  down 4 ∷
  forward 8 ∷
  forward 4 ∷
  forward 4 ∷
  down 6 ∷
  forward 3 ∷
  forward 6 ∷
  down 9 ∷
  down 9 ∷
  up 2 ∷
  forward 7 ∷
  down 8 ∷
  down 9 ∷
  down 9 ∷
  forward 7 ∷
  forward 3 ∷
  down 7 ∷
  down 8 ∷
  forward 8 ∷
  down 6 ∷
  down 5 ∷
  down 9 ∷
  down 3 ∷
  forward 1 ∷
  down 5 ∷
  forward 2 ∷
  forward 8 ∷
  down 2 ∷
  forward 6 ∷
  forward 3 ∷
  down 7 ∷
  down 4 ∷
  forward 8 ∷
  forward 1 ∷
  down 6 ∷
  forward 9 ∷
  forward 6 ∷
  up 1 ∷
  up 3 ∷
  down 8 ∷
  forward 1 ∷
  up 5 ∷
  down 4 ∷
  forward 7 ∷
  up 3 ∷
  down 2 ∷
  forward 1 ∷
  forward 9 ∷
  down 9 ∷
  down 7 ∷
  forward 8 ∷
  down 4 ∷
  up 3 ∷
  down 4 ∷
  forward 2 ∷
  forward 6 ∷
  down 7 ∷
  forward 6 ∷
  down 6 ∷
  down 4 ∷
  down 1 ∷
  up 9 ∷
  down 4 ∷
  down 7 ∷
  up 4 ∷
  down 9 ∷
  forward 6 ∷
  down 3 ∷
  forward 2 ∷
  down 4 ∷
  forward 3 ∷
  down 5 ∷
  up 9 ∷
  forward 8 ∷
  up 7 ∷
  up 6 ∷
  up 4 ∷
  forward 1 ∷
  down 1 ∷
  forward 4 ∷
  up 6 ∷
  forward 5 ∷
  forward 4 ∷
  forward 5 ∷
  up 6 ∷
  down 1 ∷
  forward 3 ∷
  up 7 ∷
  down 9 ∷
  up 9 ∷
  down 5 ∷
  forward 6 ∷
  forward 4 ∷
  up 1 ∷
  down 4 ∷
  up 1 ∷
  forward 3 ∷
  forward 1 ∷
  down 3 ∷
  forward 7 ∷
  down 2 ∷
  forward 3 ∷
  up 2 ∷
  forward 8 ∷
  down 3 ∷
  up 9 ∷
  down 5 ∷
  forward 6 ∷
  down 1 ∷
  down 8 ∷
  down 5 ∷
  forward 1 ∷
  down 6 ∷
  up 2 ∷
  forward 6 ∷
  down 2 ∷
  down 1 ∷
  up 6 ∷
  up 7 ∷
  down 5 ∷
  forward 7 ∷
  forward 6 ∷
  forward 6 ∷
  down 7 ∷
  forward 4 ∷
  down 5 ∷
  up 5 ∷
  down 1 ∷
  up 8 ∷
  down 8 ∷
  down 2 ∷
  down 2 ∷
  down 9 ∷
  up 9 ∷
  forward 2 ∷
  forward 7 ∷
  down 7 ∷
  down 4 ∷
  down 4 ∷
  down 8 ∷
  forward 5 ∷
  forward 2 ∷
  up 9 ∷
  down 9 ∷
  forward 7 ∷
  up 9 ∷
  down 2 ∷
  down 7 ∷
  up 2 ∷
  up 8 ∷
  forward 8 ∷
  down 4 ∷
  forward 3 ∷
  forward 4 ∷
  forward 6 ∷
  forward 2 ∷
  down 1 ∷
  down 2 ∷
  forward 2 ∷
  up 1 ∷
  down 1 ∷
  forward 5 ∷
  up 3 ∷
  up 3 ∷
  down 3 ∷
  down 1 ∷
  down 4 ∷
  up 5 ∷
  up 6 ∷
  forward 5 ∷
  up 7 ∷
  forward 6 ∷
  down 4 ∷
  down 7 ∷
  up 8 ∷
  forward 1 ∷
  down 5 ∷
  up 4 ∷
  up 3 ∷
  up 5 ∷
  down 1 ∷
  up 5 ∷
  forward 3 ∷
  up 5 ∷
  forward 2 ∷
  forward 2 ∷
  forward 5 ∷
  forward 2 ∷
  up 9 ∷
  forward 4 ∷
  down 1 ∷
  down 3 ∷
  down 5 ∷
  up 2 ∷
  down 8 ∷
  forward 8 ∷
  forward 9 ∷
  down 1 ∷
  down 3 ∷
  forward 8 ∷
  forward 2 ∷
  down 2 ∷
  down 1 ∷
  up 7 ∷
  forward 2 ∷
  forward 8 ∷
  down 9 ∷
  forward 1 ∷
  forward 4 ∷
  down 7 ∷
  down 4 ∷
  up 7 ∷
  down 3 ∷
  down 1 ∷
  down 4 ∷
  up 7 ∷
  down 6 ∷
  forward 7 ∷
  down 8 ∷
  up 2 ∷
  up 4 ∷
  up 6 ∷
  down 9 ∷
  down 9 ∷
  down 8 ∷
  forward 6 ∷
  up 3 ∷
  up 1 ∷
  forward 9 ∷
  forward 6 ∷
  up 4 ∷
  up 2 ∷
  up 7 ∷
  forward 5 ∷
  up 9 ∷
  up 9 ∷
  forward 9 ∷
  up 6 ∷
  down 1 ∷
  down 3 ∷
  forward 3 ∷
  down 2 ∷
  down 2 ∷
  down 6 ∷
  down 9 ∷
  forward 3 ∷
  forward 7 ∷
  up 3 ∷
  forward 3 ∷
  down 5 ∷
  forward 9 ∷
  up 6 ∷
  down 2 ∷
  forward 8 ∷
  down 3 ∷
  up 5 ∷
  down 6 ∷
  forward 9 ∷
  down 5 ∷
  down 2 ∷
  down 6 ∷
  forward 8 ∷
  forward 6 ∷
  down 1 ∷
  forward 6 ∷
  up 1 ∷
  up 7 ∷
  down 4 ∷
  down 7 ∷
  forward 4 ∷
  forward 7 ∷
  down 4 ∷
  forward 8 ∷
  down 8 ∷
  down 7 ∷
  forward 9 ∷
  down 1 ∷
  down 3 ∷
  down 6 ∷
  forward 7 ∷
  forward 6 ∷
  forward 3 ∷
  forward 8 ∷
  down 5 ∷
  down 3 ∷
  up 1 ∷
  down 9 ∷
  down 8 ∷
  forward 3 ∷
  down 6 ∷
  down 1 ∷
  forward 5 ∷
  forward 5 ∷
  forward 9 ∷
  up 5 ∷
  down 6 ∷
  up 9 ∷
  down 7 ∷
  down 6 ∷
  up 1 ∷
  forward 5 ∷
  forward 7 ∷
  forward 8 ∷
  forward 7 ∷
  forward 6 ∷
  forward 3 ∷
  forward 1 ∷
  forward 2 ∷
  up 4 ∷
  forward 3 ∷
  forward 4 ∷
  forward 5 ∷
  up 2 ∷
  up 3 ∷
  forward 4 ∷
  down 9 ∷
  up 4 ∷
  forward 7 ∷
  down 6 ∷
  down 6 ∷
  down 1 ∷
  forward 2 ∷
  down 2 ∷
  forward 2 ∷
  down 3 ∷
  forward 7 ∷
  forward 8 ∷
  down 4 ∷
  up 7 ∷
  forward 7 ∷
  down 7 ∷
  forward 7 ∷
  forward 9 ∷
  down 7 ∷
  up 2 ∷
  down 3 ∷
  forward 7 ∷
  down 1 ∷
  forward 8 ∷
  forward 2 ∷
  up 9 ∷
  down 3 ∷
  forward 2 ∷
  up 4 ∷
  forward 9 ∷
  down 4 ∷
  down 4 ∷
  forward 4 ∷
  down 2 ∷
  down 9 ∷
  forward 4 ∷
  down 2 ∷
  down 6 ∷
  forward 9 ∷
  forward 2 ∷
  up 1 ∷
  forward 2 ∷
  forward 3 ∷
  down 5 ∷
  up 8 ∷
  down 4 ∷
  down 4 ∷
  forward 7 ∷
  down 2 ∷
  up 6 ∷
  down 9 ∷
  forward 9 ∷
  up 1 ∷
  forward 3 ∷
  down 5 ∷
  forward 3 ∷
  down 3 ∷
  forward 4 ∷
  up 3 ∷
  down 6 ∷
  down 7 ∷
  down 4 ∷
  down 8 ∷
  down 4 ∷
  down 5 ∷
  up 9 ∷
  up 1 ∷
  down 7 ∷
  up 3 ∷
  up 3 ∷
  down 3 ∷
  up 4 ∷
  up 6 ∷
  forward 8 ∷
  down 1 ∷
  forward 7 ∷
  forward 4 ∷
  down 9 ∷
  down 1 ∷
  forward 7 ∷
  forward 9 ∷
  forward 1 ∷
  down 3 ∷
  down 2 ∷
  forward 3 ∷
  forward 2 ∷
  down 7 ∷
  forward 9 ∷
  forward 6 ∷
  up 9 ∷
  down 2 ∷
  forward 9 ∷
  up 6 ∷
  forward 8 ∷
  up 1 ∷
  down 5 ∷
  down 8 ∷
  forward 1 ∷
  down 1 ∷
  forward 9 ∷
  up 1 ∷
  forward 9 ∷
  forward 1 ∷
  forward 1 ∷
  down 7 ∷
  forward 3 ∷
  forward 6 ∷
  down 5 ∷
  forward 7 ∷
  forward 1 ∷
  down 7 ∷
  down 6 ∷
  down 6 ∷
  forward 5 ∷
  up 6 ∷
  down 6 ∷
  forward 8 ∷
  up 2 ∷
  down 8 ∷
  down 3 ∷
  up 5 ∷
  up 8 ∷
  down 6 ∷
  forward 4 ∷
  forward 2 ∷
  up 3 ∷
  forward 5 ∷
  forward 3 ∷
  up 8 ∷
  forward 6 ∷
  up 8 ∷
  forward 1 ∷
  up 8 ∷
  up 7 ∷
  up 6 ∷
  forward 2 ∷
  down 9 ∷
  down 9 ∷
  forward 3 ∷
  down 7 ∷
  forward 3 ∷
  down 6 ∷
  forward 9 ∷
  up 5 ∷
  down 1 ∷
  forward 7 ∷
  down 1 ∷
  down 5 ∷
  down 9 ∷
  forward 8 ∷
  forward 9 ∷
  forward 7 ∷
  down 9 ∷
  up 4 ∷
  forward 5 ∷
  down 5 ∷
  forward 5 ∷
  down 9 ∷
  forward 9 ∷
  forward 3 ∷
  up 5 ∷
  forward 8 ∷
  up 5 ∷
  down 1 ∷
  forward 8 ∷
  down 3 ∷
  forward 6 ∷
  up 9 ∷
  forward 8 ∷
  down 4 ∷
  forward 3 ∷
  down 5 ∷
  forward 8 ∷
  forward 9 ∷
  forward 2 ∷
  down 1 ∷
  down 6 ∷
  down 4 ∷
  forward 9 ∷
  up 2 ∷
  down 3 ∷
  down 6 ∷
  down 3 ∷
  down 9 ∷
  down 1 ∷
  up 6 ∷
  down 2 ∷
  down 7 ∷
  up 5 ∷
  forward 5 ∷
  up 1 ∷
  down 7 ∷
  forward 6 ∷
  up 6 ∷
  down 2 ∷
  down 3 ∷
  forward 3 ∷
  down 5 ∷
  forward 8 ∷
  down 9 ∷
  down 7 ∷
  down 8 ∷
  up 7 ∷
  down 1 ∷
  forward 1 ∷
  forward 1 ∷
  down 2 ∷
  up 4 ∷
  forward 2 ∷
  down 3 ∷
  up 2 ∷
  down 3 ∷
  down 2 ∷
  forward 7 ∷
  down 1 ∷
  up 7 ∷
  down 2 ∷
  down 1 ∷
  forward 6 ∷
  down 9 ∷
  up 9 ∷
  down 4 ∷
  down 6 ∷
  up 9 ∷
  forward 7 ∷
  forward 9 ∷
  forward 7 ∷
  down 4 ∷
  down 1 ∷
  forward 7 ∷
  down 4 ∷
  down 7 ∷
  down 3 ∷
  down 5 ∷
  forward 3 ∷
  down 8 ∷
  forward 8 ∷
  forward 7 ∷
  forward 8 ∷
  down 4 ∷
  down 9 ∷
  forward 2 ∷
  forward 7 ∷
  up 8 ∷
  forward 4 ∷
  down 6 ∷
  up 8 ∷
  down 2 ∷
  forward 3 ∷
  down 6 ∷
  down 8 ∷
  forward 8 ∷
  forward 2 ∷
  forward 9 ∷
  up 6 ∷
  forward 7 ∷
  down 3 ∷
  down 5 ∷
  forward 8 ∷
  forward 9 ∷
  down 3 ∷
  forward 3 ∷
  forward 2 ∷
  forward 3 ∷
  down 8 ∷
  up 9 ∷
  up 5 ∷
  up 2 ∷
  up 6 ∷
  up 1 ∷
  up 1 ∷
  up 5 ∷
  forward 3 ∷
  forward 2 ∷
  down 3 ∷
  forward 4 ∷
  []

main : IO ⊤
main = putStrLn (shopMaybeNat (doTask input))


private
  -- checks from the exercise text
  _ : apply (forward 5) (state 0 0 0) ≡ just (state 5 0 0)
  _ = refl

  _ : apply (down 5) (state 5 0 0) ≡ just (state 5 0 5)
  _ = refl

  _ : apply (forward 8) (state 5 0 5) ≡ just (state 13 (8 * 5) 5)
  _ = refl

  _ : apply (up 3) (state 13 40 5) ≡ just (state 13 40 2)
  _ = refl

  _ : apply (down 8) (state 13 40 2) ≡ just (state 13 40 10)
  _ = refl

  _ : apply (forward 2) (state 13 40 10) ≡ just (state 15 60 10)
  _ = refl

  -- submarine does not 'fly'
  _ : apply (up 7) (state 13 2 2) ≡ nothing
  _ = refl
