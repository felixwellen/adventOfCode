{-
  Day 2 task of https://adventofcode.com/
-}
module a2 where

open import Agda.Builtin.IO using (IO)
open import Agda.Builtin.Unit using (⊤)
open import Agda.Builtin.String using (String; primShowNat; primStringAppend)
open import Agda.Builtin.Equality

open import Data.Nat
open import Data.Bool using (if_then_else_)
open import Data.List
open import Data.Maybe renaming (map to maybeMap)

postulate putStrLn : String → IO ⊤
{-# FOREIGN GHC import qualified Data.Text as T #-}
{-# COMPILE GHC putStrLn = putStrLn . T.unpack #-}

-- helper
shopMaybeNat : Maybe ℕ → String
shopMaybeNat (just n) = primShowNat n
shopMaybeNat nothing = "nothing"

data Command : Set where
  forward : ℕ → Command
  up      : ℕ → Command
  down    : ℕ → Command

record Position : Set where
  constructor pos
  field
    h : ℕ
    d : ℕ

open Position

apply : Command → Position → Maybe Position

apply (forward x) (pos h d) = just (pos (h + x) d)

apply (up x)      (pos h d) = if d <ᵇ x
                              then nothing
                              else just (pos h ∣ d - x ∣)

apply (down x)    (pos h d) = just (pos h (d + x))


iterate : List Command → Position → Maybe Position
iterate [] p = just p
iterate (command ∷ list) p with apply command p
...                           | just q  = iterate list q
...                           | nothing = nothing

doTask : List Command → Maybe ℕ
doTask list = let maybeResult = iterate list (pos 0 0)
              in maybeMap multiplyComponents maybeResult
  where multiplyComponents : Position → ℕ
        multiplyComponents (pos h d) = h * d

input : List Command
input =
  forward 2 ∷
  forward 3 ∷
  forward 5 ∷
  forward 6 ∷
  down 7 ∷
  forward 8 ∷
  forward 4 ∷
  forward 7 ∷
  forward 5 ∷
  forward 5 ∷
  down 4 ∷
  down 9 ∷
  forward 8 ∷
  forward 5 ∷
  up 5 ∷
  down 5 ∷
  forward 3 ∷
  down 4 ∷
  down 8 ∷
  forward 9 ∷
  down 1 ∷
  up 9 ∷
  down 7 ∷
  up 7 ∷
  up 1 ∷
  forward 1 ∷
  down 1 ∷
  down 4 ∷
  down 4 ∷
  down 8 ∷
  down 4 ∷
  up 3 ∷
  down 1 ∷
  down 3 ∷
  forward 7 ∷
  down 6 ∷
  forward 3 ∷
  forward 5 ∷
  forward 2 ∷
  up 9 ∷
  forward 7 ∷
  up 5 ∷
  down 3 ∷
  forward 1 ∷
  forward 2 ∷
  down 3 ∷
  down 8 ∷
  down 3 ∷
  forward 8 ∷
  up 5 ∷
  down 5 ∷
  forward 3 ∷
  down 5 ∷
  forward 9 ∷
  down 3 ∷
  down 4 ∷
  down 9 ∷
  down 7 ∷
  up 3 ∷
  down 9 ∷
  up 9 ∷
  up 1 ∷
  forward 3 ∷
  up 4 ∷
  down 3 ∷
  forward 7 ∷
  forward 7 ∷
  up 7 ∷
  forward 6 ∷
  down 7 ∷
  down 6 ∷
  forward 2 ∷
  forward 9 ∷
  down 5 ∷
  forward 4 ∷
  up 6 ∷
  down 1 ∷
  down 9 ∷
  down 9 ∷
  forward 4 ∷
  down 1 ∷
  forward 6 ∷
  down 1 ∷
  down 5 ∷
  down 4 ∷
  down 4 ∷
  forward 4 ∷
  forward 9 ∷
  up 1 ∷
  down 2 ∷
  down 8 ∷
  down 5 ∷
  down 8 ∷
  down 8 ∷
  up 2 ∷
  forward 8 ∷
  up 1 ∷
  forward 4 ∷
  down 5 ∷
  down 1 ∷
  up 2 ∷
  forward 6 ∷
  forward 9 ∷
  forward 2 ∷
  forward 6 ∷
  forward 9 ∷
  up 6 ∷
  forward 9 ∷
  up 4 ∷
  down 7 ∷
  up 6 ∷
  forward 2 ∷
  down 1 ∷
  up 3 ∷
  forward 1 ∷
  forward 8 ∷
  down 6 ∷
  down 8 ∷
  down 8 ∷
  forward 8 ∷
  forward 2 ∷
  forward 2 ∷
  down 2 ∷
  up 1 ∷
  down 9 ∷
  up 9 ∷
  down 9 ∷
  up 3 ∷
  forward 9 ∷
  up 4 ∷
  up 7 ∷
  up 6 ∷
  down 9 ∷
  forward 1 ∷
  down 3 ∷
  down 4 ∷
  forward 8 ∷
  down 3 ∷
  down 9 ∷
  up 3 ∷
  forward 2 ∷
  up 5 ∷
  down 3 ∷
  forward 8 ∷
  up 3 ∷
  down 3 ∷
  forward 2 ∷
  forward 9 ∷
  down 1 ∷
  down 9 ∷
  down 4 ∷
  up 7 ∷
  down 4 ∷
  up 6 ∷
  forward 5 ∷
  down 6 ∷
  forward 3 ∷
  down 2 ∷
  forward 1 ∷
  forward 8 ∷
  down 4 ∷
  forward 1 ∷
  up 7 ∷
  forward 6 ∷
  up 9 ∷
  forward 6 ∷
  down 3 ∷
  forward 2 ∷
  down 4 ∷
  forward 6 ∷
  down 3 ∷
  down 6 ∷
  down 1 ∷
  down 1 ∷
  down 5 ∷
  forward 3 ∷
  forward 9 ∷
  forward 8 ∷
  down 3 ∷
  forward 7 ∷
  up 9 ∷
  forward 9 ∷
  up 2 ∷
  forward 4 ∷
  up 3 ∷
  forward 1 ∷
  up 6 ∷
  up 8 ∷
  down 5 ∷
  down 6 ∷
  up 9 ∷
  down 6 ∷
  down 9 ∷
  up 9 ∷
  down 4 ∷
  forward 5 ∷
  up 2 ∷
  down 3 ∷
  up 3 ∷
  down 1 ∷
  forward 3 ∷
  down 5 ∷
  forward 7 ∷
  down 6 ∷
  down 7 ∷
  down 5 ∷
  forward 2 ∷
  up 6 ∷
  down 9 ∷
  down 4 ∷
  down 3 ∷
  forward 9 ∷
  up 8 ∷
  forward 2 ∷
  down 2 ∷
  forward 4 ∷
  up 6 ∷
  down 4 ∷
  up 8 ∷
  down 7 ∷
  down 2 ∷
  up 6 ∷
  up 4 ∷
  down 2 ∷
  forward 5 ∷
  up 4 ∷
  down 8 ∷
  forward 3 ∷
  forward 1 ∷
  down 7 ∷
  forward 8 ∷
  forward 7 ∷
  down 7 ∷
  up 4 ∷
  forward 8 ∷
  down 5 ∷
  up 9 ∷
  forward 1 ∷
  forward 4 ∷
  forward 9 ∷
  forward 7 ∷
  down 9 ∷
  up 9 ∷
  down 1 ∷
  down 7 ∷
  forward 7 ∷
  down 7 ∷
  down 7 ∷
  down 3 ∷
  down 5 ∷
  forward 3 ∷
  down 2 ∷
  forward 6 ∷
  down 9 ∷
  up 5 ∷
  up 3 ∷
  forward 5 ∷
  down 6 ∷
  down 1 ∷
  forward 4 ∷
  down 3 ∷
  forward 8 ∷
  down 7 ∷
  forward 7 ∷
  forward 7 ∷
  up 7 ∷
  up 2 ∷
  up 3 ∷
  forward 9 ∷
  down 5 ∷
  up 2 ∷
  forward 5 ∷
  up 5 ∷
  forward 2 ∷
  forward 2 ∷
  down 8 ∷
  forward 2 ∷
  up 4 ∷
  forward 1 ∷
  forward 3 ∷
  up 8 ∷
  up 9 ∷
  forward 5 ∷
  down 1 ∷
  up 8 ∷
  down 4 ∷
  down 8 ∷
  up 4 ∷
  forward 9 ∷
  down 6 ∷
  down 8 ∷
  up 2 ∷
  up 3 ∷
  down 7 ∷
  down 4 ∷
  forward 5 ∷
  down 6 ∷
  forward 3 ∷
  forward 3 ∷
  forward 8 ∷
  down 1 ∷
  down 7 ∷
  down 9 ∷
  down 2 ∷
  down 7 ∷
  forward 7 ∷
  down 7 ∷
  down 6 ∷
  up 6 ∷
  forward 8 ∷
  forward 5 ∷
  up 5 ∷
  down 2 ∷
  up 8 ∷
  up 4 ∷
  down 9 ∷
  up 2 ∷
  forward 5 ∷
  up 2 ∷
  down 4 ∷
  up 4 ∷
  forward 2 ∷
  forward 4 ∷
  forward 9 ∷
  forward 9 ∷
  up 4 ∷
  up 5 ∷
  down 1 ∷
  down 6 ∷
  down 1 ∷
  down 4 ∷
  down 5 ∷
  down 3 ∷
  forward 3 ∷
  down 9 ∷
  forward 6 ∷
  down 3 ∷
  down 9 ∷
  down 2 ∷
  up 2 ∷
  down 2 ∷
  down 7 ∷
  forward 9 ∷
  down 3 ∷
  down 3 ∷
  down 2 ∷
  down 3 ∷
  forward 2 ∷
  down 9 ∷
  down 9 ∷
  up 5 ∷
  up 3 ∷
  forward 4 ∷
  up 7 ∷
  forward 8 ∷
  up 6 ∷
  forward 7 ∷
  down 7 ∷
  down 1 ∷
  forward 5 ∷
  down 2 ∷
  up 1 ∷
  down 8 ∷
  up 3 ∷
  forward 2 ∷
  up 9 ∷
  down 1 ∷
  down 3 ∷
  down 6 ∷
  down 2 ∷
  down 7 ∷
  up 2 ∷
  forward 5 ∷
  forward 7 ∷
  down 2 ∷
  forward 5 ∷
  forward 4 ∷
  forward 5 ∷
  down 3 ∷
  forward 7 ∷
  down 7 ∷
  forward 8 ∷
  down 3 ∷
  down 2 ∷
  up 1 ∷
  forward 6 ∷
  down 4 ∷
  down 2 ∷
  forward 7 ∷
  up 3 ∷
  down 4 ∷
  forward 2 ∷
  up 6 ∷
  down 3 ∷
  up 6 ∷
  up 8 ∷
  down 9 ∷
  up 6 ∷
  forward 8 ∷
  forward 9 ∷
  forward 4 ∷
  forward 7 ∷
  down 2 ∷
  forward 9 ∷
  down 7 ∷
  up 9 ∷
  down 5 ∷
  down 6 ∷
  up 5 ∷
  down 4 ∷
  forward 8 ∷
  forward 4 ∷
  forward 4 ∷
  down 6 ∷
  forward 3 ∷
  forward 6 ∷
  down 9 ∷
  down 9 ∷
  up 2 ∷
  forward 7 ∷
  down 8 ∷
  down 9 ∷
  down 9 ∷
  forward 7 ∷
  forward 3 ∷
  down 7 ∷
  down 8 ∷
  forward 8 ∷
  down 6 ∷
  down 5 ∷
  down 9 ∷
  down 3 ∷
  forward 1 ∷
  down 5 ∷
  forward 2 ∷
  forward 8 ∷
  down 2 ∷
  forward 6 ∷
  forward 3 ∷
  down 7 ∷
  down 4 ∷
  forward 8 ∷
  forward 1 ∷
  down 6 ∷
  forward 9 ∷
  forward 6 ∷
  up 1 ∷
  up 3 ∷
  down 8 ∷
  forward 1 ∷
  up 5 ∷
  down 4 ∷
  forward 7 ∷
  up 3 ∷
  down 2 ∷
  forward 1 ∷
  forward 9 ∷
  down 9 ∷
  down 7 ∷
  forward 8 ∷
  down 4 ∷
  up 3 ∷
  down 4 ∷
  forward 2 ∷
  forward 6 ∷
  down 7 ∷
  forward 6 ∷
  down 6 ∷
  down 4 ∷
  down 1 ∷
  up 9 ∷
  down 4 ∷
  down 7 ∷
  up 4 ∷
  down 9 ∷
  forward 6 ∷
  down 3 ∷
  forward 2 ∷
  down 4 ∷
  forward 3 ∷
  down 5 ∷
  up 9 ∷
  forward 8 ∷
  up 7 ∷
  up 6 ∷
  up 4 ∷
  forward 1 ∷
  down 1 ∷
  forward 4 ∷
  up 6 ∷
  forward 5 ∷
  forward 4 ∷
  forward 5 ∷
  up 6 ∷
  down 1 ∷
  forward 3 ∷
  up 7 ∷
  down 9 ∷
  up 9 ∷
  down 5 ∷
  forward 6 ∷
  forward 4 ∷
  up 1 ∷
  down 4 ∷
  up 1 ∷
  forward 3 ∷
  forward 1 ∷
  down 3 ∷
  forward 7 ∷
  down 2 ∷
  forward 3 ∷
  up 2 ∷
  forward 8 ∷
  down 3 ∷
  up 9 ∷
  down 5 ∷
  forward 6 ∷
  down 1 ∷
  down 8 ∷
  down 5 ∷
  forward 1 ∷
  down 6 ∷
  up 2 ∷
  forward 6 ∷
  down 2 ∷
  down 1 ∷
  up 6 ∷
  up 7 ∷
  down 5 ∷
  forward 7 ∷
  forward 6 ∷
  forward 6 ∷
  down 7 ∷
  forward 4 ∷
  down 5 ∷
  up 5 ∷
  down 1 ∷
  up 8 ∷
  down 8 ∷
  down 2 ∷
  down 2 ∷
  down 9 ∷
  up 9 ∷
  forward 2 ∷
  forward 7 ∷
  down 7 ∷
  down 4 ∷
  down 4 ∷
  down 8 ∷
  forward 5 ∷
  forward 2 ∷
  up 9 ∷
  down 9 ∷
  forward 7 ∷
  up 9 ∷
  down 2 ∷
  down 7 ∷
  up 2 ∷
  up 8 ∷
  forward 8 ∷
  down 4 ∷
  forward 3 ∷
  forward 4 ∷
  forward 6 ∷
  forward 2 ∷
  down 1 ∷
  down 2 ∷
  forward 2 ∷
  up 1 ∷
  down 1 ∷
  forward 5 ∷
  up 3 ∷
  up 3 ∷
  down 3 ∷
  down 1 ∷
  down 4 ∷
  up 5 ∷
  up 6 ∷
  forward 5 ∷
  up 7 ∷
  forward 6 ∷
  down 4 ∷
  down 7 ∷
  up 8 ∷
  forward 1 ∷
  down 5 ∷
  up 4 ∷
  up 3 ∷
  up 5 ∷
  down 1 ∷
  up 5 ∷
  forward 3 ∷
  up 5 ∷
  forward 2 ∷
  forward 2 ∷
  forward 5 ∷
  forward 2 ∷
  up 9 ∷
  forward 4 ∷
  down 1 ∷
  down 3 ∷
  down 5 ∷
  up 2 ∷
  down 8 ∷
  forward 8 ∷
  forward 9 ∷
  down 1 ∷
  down 3 ∷
  forward 8 ∷
  forward 2 ∷
  down 2 ∷
  down 1 ∷
  up 7 ∷
  forward 2 ∷
  forward 8 ∷
  down 9 ∷
  forward 1 ∷
  forward 4 ∷
  down 7 ∷
  down 4 ∷
  up 7 ∷
  down 3 ∷
  down 1 ∷
  down 4 ∷
  up 7 ∷
  down 6 ∷
  forward 7 ∷
  down 8 ∷
  up 2 ∷
  up 4 ∷
  up 6 ∷
  down 9 ∷
  down 9 ∷
  down 8 ∷
  forward 6 ∷
  up 3 ∷
  up 1 ∷
  forward 9 ∷
  forward 6 ∷
  up 4 ∷
  up 2 ∷
  up 7 ∷
  forward 5 ∷
  up 9 ∷
  up 9 ∷
  forward 9 ∷
  up 6 ∷
  down 1 ∷
  down 3 ∷
  forward 3 ∷
  down 2 ∷
  down 2 ∷
  down 6 ∷
  down 9 ∷
  forward 3 ∷
  forward 7 ∷
  up 3 ∷
  forward 3 ∷
  down 5 ∷
  forward 9 ∷
  up 6 ∷
  down 2 ∷
  forward 8 ∷
  down 3 ∷
  up 5 ∷
  down 6 ∷
  forward 9 ∷
  down 5 ∷
  down 2 ∷
  down 6 ∷
  forward 8 ∷
  forward 6 ∷
  down 1 ∷
  forward 6 ∷
  up 1 ∷
  up 7 ∷
  down 4 ∷
  down 7 ∷
  forward 4 ∷
  forward 7 ∷
  down 4 ∷
  forward 8 ∷
  down 8 ∷
  down 7 ∷
  forward 9 ∷
  down 1 ∷
  down 3 ∷
  down 6 ∷
  forward 7 ∷
  forward 6 ∷
  forward 3 ∷
  forward 8 ∷
  down 5 ∷
  down 3 ∷
  up 1 ∷
  down 9 ∷
  down 8 ∷
  forward 3 ∷
  down 6 ∷
  down 1 ∷
  forward 5 ∷
  forward 5 ∷
  forward 9 ∷
  up 5 ∷
  down 6 ∷
  up 9 ∷
  down 7 ∷
  down 6 ∷
  up 1 ∷
  forward 5 ∷
  forward 7 ∷
  forward 8 ∷
  forward 7 ∷
  forward 6 ∷
  forward 3 ∷
  forward 1 ∷
  forward 2 ∷
  up 4 ∷
  forward 3 ∷
  forward 4 ∷
  forward 5 ∷
  up 2 ∷
  up 3 ∷
  forward 4 ∷
  down 9 ∷
  up 4 ∷
  forward 7 ∷
  down 6 ∷
  down 6 ∷
  down 1 ∷
  forward 2 ∷
  down 2 ∷
  forward 2 ∷
  down 3 ∷
  forward 7 ∷
  forward 8 ∷
  down 4 ∷
  up 7 ∷
  forward 7 ∷
  down 7 ∷
  forward 7 ∷
  forward 9 ∷
  down 7 ∷
  up 2 ∷
  down 3 ∷
  forward 7 ∷
  down 1 ∷
  forward 8 ∷
  forward 2 ∷
  up 9 ∷
  down 3 ∷
  forward 2 ∷
  up 4 ∷
  forward 9 ∷
  down 4 ∷
  down 4 ∷
  forward 4 ∷
  down 2 ∷
  down 9 ∷
  forward 4 ∷
  down 2 ∷
  down 6 ∷
  forward 9 ∷
  forward 2 ∷
  up 1 ∷
  forward 2 ∷
  forward 3 ∷
  down 5 ∷
  up 8 ∷
  down 4 ∷
  down 4 ∷
  forward 7 ∷
  down 2 ∷
  up 6 ∷
  down 9 ∷
  forward 9 ∷
  up 1 ∷
  forward 3 ∷
  down 5 ∷
  forward 3 ∷
  down 3 ∷
  forward 4 ∷
  up 3 ∷
  down 6 ∷
  down 7 ∷
  down 4 ∷
  down 8 ∷
  down 4 ∷
  down 5 ∷
  up 9 ∷
  up 1 ∷
  down 7 ∷
  up 3 ∷
  up 3 ∷
  down 3 ∷
  up 4 ∷
  up 6 ∷
  forward 8 ∷
  down 1 ∷
  forward 7 ∷
  forward 4 ∷
  down 9 ∷
  down 1 ∷
  forward 7 ∷
  forward 9 ∷
  forward 1 ∷
  down 3 ∷
  down 2 ∷
  forward 3 ∷
  forward 2 ∷
  down 7 ∷
  forward 9 ∷
  forward 6 ∷
  up 9 ∷
  down 2 ∷
  forward 9 ∷
  up 6 ∷
  forward 8 ∷
  up 1 ∷
  down 5 ∷
  down 8 ∷
  forward 1 ∷
  down 1 ∷
  forward 9 ∷
  up 1 ∷
  forward 9 ∷
  forward 1 ∷
  forward 1 ∷
  down 7 ∷
  forward 3 ∷
  forward 6 ∷
  down 5 ∷
  forward 7 ∷
  forward 1 ∷
  down 7 ∷
  down 6 ∷
  down 6 ∷
  forward 5 ∷
  up 6 ∷
  down 6 ∷
  forward 8 ∷
  up 2 ∷
  down 8 ∷
  down 3 ∷
  up 5 ∷
  up 8 ∷
  down 6 ∷
  forward 4 ∷
  forward 2 ∷
  up 3 ∷
  forward 5 ∷
  forward 3 ∷
  up 8 ∷
  forward 6 ∷
  up 8 ∷
  forward 1 ∷
  up 8 ∷
  up 7 ∷
  up 6 ∷
  forward 2 ∷
  down 9 ∷
  down 9 ∷
  forward 3 ∷
  down 7 ∷
  forward 3 ∷
  down 6 ∷
  forward 9 ∷
  up 5 ∷
  down 1 ∷
  forward 7 ∷
  down 1 ∷
  down 5 ∷
  down 9 ∷
  forward 8 ∷
  forward 9 ∷
  forward 7 ∷
  down 9 ∷
  up 4 ∷
  forward 5 ∷
  down 5 ∷
  forward 5 ∷
  down 9 ∷
  forward 9 ∷
  forward 3 ∷
  up 5 ∷
  forward 8 ∷
  up 5 ∷
  down 1 ∷
  forward 8 ∷
  down 3 ∷
  forward 6 ∷
  up 9 ∷
  forward 8 ∷
  down 4 ∷
  forward 3 ∷
  down 5 ∷
  forward 8 ∷
  forward 9 ∷
  forward 2 ∷
  down 1 ∷
  down 6 ∷
  down 4 ∷
  forward 9 ∷
  up 2 ∷
  down 3 ∷
  down 6 ∷
  down 3 ∷
  down 9 ∷
  down 1 ∷
  up 6 ∷
  down 2 ∷
  down 7 ∷
  up 5 ∷
  forward 5 ∷
  up 1 ∷
  down 7 ∷
  forward 6 ∷
  up 6 ∷
  down 2 ∷
  down 3 ∷
  forward 3 ∷
  down 5 ∷
  forward 8 ∷
  down 9 ∷
  down 7 ∷
  down 8 ∷
  up 7 ∷
  down 1 ∷
  forward 1 ∷
  forward 1 ∷
  down 2 ∷
  up 4 ∷
  forward 2 ∷
  down 3 ∷
  up 2 ∷
  down 3 ∷
  down 2 ∷
  forward 7 ∷
  down 1 ∷
  up 7 ∷
  down 2 ∷
  down 1 ∷
  forward 6 ∷
  down 9 ∷
  up 9 ∷
  down 4 ∷
  down 6 ∷
  up 9 ∷
  forward 7 ∷
  forward 9 ∷
  forward 7 ∷
  down 4 ∷
  down 1 ∷
  forward 7 ∷
  down 4 ∷
  down 7 ∷
  down 3 ∷
  down 5 ∷
  forward 3 ∷
  down 8 ∷
  forward 8 ∷
  forward 7 ∷
  forward 8 ∷
  down 4 ∷
  down 9 ∷
  forward 2 ∷
  forward 7 ∷
  up 8 ∷
  forward 4 ∷
  down 6 ∷
  up 8 ∷
  down 2 ∷
  forward 3 ∷
  down 6 ∷
  down 8 ∷
  forward 8 ∷
  forward 2 ∷
  forward 9 ∷
  up 6 ∷
  forward 7 ∷
  down 3 ∷
  down 5 ∷
  forward 8 ∷
  forward 9 ∷
  down 3 ∷
  forward 3 ∷
  forward 2 ∷
  forward 3 ∷
  down 8 ∷
  up 9 ∷
  up 5 ∷
  up 2 ∷
  up 6 ∷
  up 1 ∷
  up 1 ∷
  up 5 ∷
  forward 3 ∷
  forward 2 ∷
  down 3 ∷
  forward 4 ∷
  []

main : IO ⊤
main = putStrLn (shopMaybeNat (doTask input))


private
  -- checks from the exercise text
  _ : apply (forward 5) (pos 0 0) ≡ just (pos 5 0)
  _ = refl

  _ : apply (down 5) (pos 5 0) ≡ just (pos 5 5)
  _ = refl

  _ : apply (forward 8) (pos 5 5) ≡ just (pos 13 5)
  _ = refl

  _ : apply (up 3) (pos 13 5) ≡ just (pos 13 2)
  _ = refl

  _ : apply (down 8) (pos 13 2) ≡ just (pos 13 10)
  _ = refl

  _ : apply (forward 2) (pos 13 10) ≡ just (pos 15 10)
  _ = refl

  -- submarine does not 'fly'
  _ : apply (up 7) (pos 13 2) ≡ nothing
  _ = refl
